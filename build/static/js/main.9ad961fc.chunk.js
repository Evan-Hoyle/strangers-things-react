(this["webpackJsonpstrangers-things-react"]=this["webpackJsonpstrangers-things-react"]||[]).push([[0],{29:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var s=n(0),r=n(4),a=n.n(r),c=n(8),o=n(5),i=n(1),u=n.n(i),j=n(20),l=n.n(j),p=n(10),h=n(2),b=(n(29),function(e){var t=e.type,n=e.setToken,r=e.setUser,u=Object(i.useState)(""),j=Object(o.a)(u,2),l=j[0],h=j[1],b=Object(i.useState)(""),d=Object(o.a)(b,2),O=d[0],x=d[1],f="login"===t?"Login":"Register",m="login"===t?"Register":"Login",g="login"===t?"register":"login",v=function(){var e=Object(c.a)(a.a.mark((function e(s){var c,o,i,u,j,p,b;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.next=3,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/users/".concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:l,password:O}})});case 3:return c=e.sent,e.next=6,c.json();case 6:if(o=e.sent,i=o.data,!(u=null===i||void 0===i?void 0:i.token)){e.next=19;break}return n(u),e.next=13,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/users/me",{method:"GET",headers:{Authorization:"Bearer ".concat(u)}});case 13:return j=e.sent,e.next=16,j.json();case 16:p=e.sent,b=p.data,r(b);case 19:h(""),x("");case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("h2",{children:f}),Object(s.jsxs)("form",{onSubmit:v,children:[Object(s.jsx)("input",{type:"text",value:l,onChange:function(e){return h(e.target.value)},placeholder:"username"}),Object(s.jsx)("input",{type:"password",value:O,onChange:function(e){return x(e.target.value)},placeholder:"password"}),Object(s.jsx)("button",{type:"submit",children:f})]}),Object(s.jsx)(p.b,{to:"/".concat(g),children:m})]})}),d=function(e){var t=e.post;return Object(s.jsxs)("div",{className:"post",children:[Object(s.jsx)("h3",{children:t.title}),Object(s.jsx)("p",{children:t.description}),Object(s.jsx)("p",{children:t.price}),Object(s.jsxs)("p",{children:["User: ",t.author.username]})]})},O=n(22),x=function(e){var t=e.token,n=e.posts,r=e.setPosts,u=Object(i.useState)(""),j=Object(o.a)(u,2),l=j[0],p=j[1],h=Object(i.useState)(""),b=Object(o.a)(h,2),d=b[0],x=b[1],f=Object(i.useState)(""),m=Object(o.a)(f,2),g=m[0],v=m[1],k=function(){var e=Object(c.a)(a.a.mark((function e(s){var c,o,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.next=3,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/posts",{method:"POST",headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({post:{title:l,description:d,price:g}})});case 3:return c=e.sent,e.next=6,c.json();case 6:o=e.sent,i=o.data,r([i.post].concat(Object(O.a)(n))),p(""),x(""),v("");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsx)("div",{className:"formAlign",children:Object(s.jsxs)("form",{className:"form",onSubmit:k,children:[Object(s.jsx)("input",{type:"text",value:l,placeholder:"Title",onChange:function(e){p(e.target.value)}}),Object(s.jsx)("input",{type:"text",value:d,placeholder:"Description",onChange:function(e){x(e.target.value)}}),Object(s.jsx)("input",{type:"text",value:g,placeholder:"Price",onChange:function(e){v(e.target.value)}}),Object(s.jsx)("button",{className:"submitButton btn btn-dark btn-sm",children:"Submit Post"})]})})},f=function(e){var t=e.id,n=e.token,r=e.fetchPosts,o=function(){var e=Object(c.a)(a.a.mark((function e(){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/posts/".concat(t),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}});case 2:s=e.sent,console.log(s),r();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(s.jsx)("button",{onClick:o,children:"Delete"})},m=function(e){var t=e.token,n=e.id,r=Object(i.useState)(""),u=Object(o.a)(r,2),j=u[0],l=u[1],p=function(){var e=Object(c.a)(a.a.mark((function e(s){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.next=3,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/posts/".concat(n,"/messages"),{method:"POST",headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({message:{content:j}})});case 3:r=e.sent,console.log("message",r),l("");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)("form",{onSubmit:p,children:[Object(s.jsx)("button",{className:"sendButton btn btn-dark btn-sm",children:"Send Message"}),Object(s.jsx)("input",{type:"text",value:j,onChange:function(e){l(e.target.value)}})]})},g=function(e){var t=e.token,n=Object(i.useState)([]),r=Object(o.a)(n,2),u=r[0],j=r[1],l=function(){var e=Object(c.a)(a.a.mark((function e(){var n,s,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/posts",{headers:{Authorization:"Bearer "+t}});case 2:return n=e.sent,e.next=5,n.json();case 5:s=e.sent,r=s.data,console.log(r.posts),j(r.posts);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(i.useEffect)((function(){l()}),[]),Object(s.jsxs)("div",{className:"postList",children:[t?Object(s.jsx)(x,{token:t,posts:u,setPosts:j}):"",Object(s.jsx)("h2",{children:"Posts"}),u.map((function(e){return Object(s.jsxs)(i.Fragment,{children:[" ",Object(s.jsxs)("div",{className:"postWrap",children:[Object(s.jsx)(d,{post:e}),e.isAuthor?Object(s.jsx)(f,{id:e._id,token:t,fetchPosts:l}):"",!e.isAuthor&&t?Object(s.jsx)(m,{id:e._id,token:t}):""]})]},e._id)}))]})},v=function(e){var t=e.user;console.log(t);var n=t.messages&&t.messages.length>0;return Object(s.jsxs)("div",{className:"profile",children:[Object(s.jsx)("h3",{children:"Profile"}),Object(s.jsx)("h4",{children:"Messages"}),n?t.messages.map((function(e,t){return Object(s.jsxs)("div",{className:"message",children:[Object(s.jsxs)("h5",{children:["Subject: ",e.post.title]}),Object(s.jsx)("p",{children:e.content}),Object(s.jsxs)("p",{children:["From: ",e.fromUser.username]})]},t)})):""]})},k=function(){var e=Object(i.useState)(localStorage.getItem("token")||""),t=Object(o.a)(e,2),n=t[0],r=t[1],j=Object(i.useState)({}),l=Object(o.a)(j,2),d=l[0],O=l[1];return u.a.useEffect((function(){localStorage.setItem("token",n)}),[n]),Object(i.useEffect)(Object(c.a)(a.a.mark((function e(){var t,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/users/me",{headers:{Authorization:"Bearer "+n}});case 2:return t=e.sent,e.next=5,t.json();case 5:s=e.sent,console.log(s),s.success&&O(s.data);case 8:case"end":return e.stop()}}),e)}))),[n]),Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("h1",{children:"Strangers Things"}),d.username&&Object(s.jsxs)("div",{className:"hello",children:["Hello ",d.username,Object(s.jsx)("button",{className:"logout",onClick:function(){O({}),r(""),localStorage.removeItem("token")},children:"Logout"})]}),Object(s.jsx)("div",{children:Object(s.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark",children:Object(s.jsx)("div",{id:"navbarNav",children:Object(s.jsxs)("ul",{className:"navbar-nav",children:[n?"":Object(s.jsx)("li",{className:"nav-item active",children:Object(s.jsx)(p.b,{className:"nav-link",to:"/login",children:"Login"})}),Object(s.jsx)("li",{className:"nav-item",children:Object(s.jsx)(p.b,{className:"nav-link",to:"/posts",children:"Posts"})}),n?Object(s.jsx)("li",{className:"nav-item",children:Object(s.jsx)(p.b,{className:"nav-link",to:"/profile",children:"Profile"})}):""]})})})}),Object(s.jsx)(h.a,{path:"/login",children:Object(s.jsx)(b,{type:"login",setToken:r,setUser:O})}),Object(s.jsx)(h.a,{path:"/register",children:Object(s.jsx)(b,{type:"register",setToken:r,setUser:O})}),Object(s.jsx)(h.a,{path:"/posts",children:Object(s.jsx)(g,{token:n})}),Object(s.jsx)(h.a,{path:"/profile",children:Object(s.jsx)(v,{user:d})})]})};l.a.render(Object(s.jsx)(p.a,{children:Object(s.jsx)(k,{})}),document.getElementById("app"))}},[[35,1,2]]]);
//# sourceMappingURL=main.9ad961fc.chunk.js.map